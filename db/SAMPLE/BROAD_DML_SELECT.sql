USE BROAD;

# 방송사와 요일을 선택하면 해당 방송사의 프로그램들이 방영시간 순으로 조회되는 쿼리
# - 방송사를 선택하면 해당 방송사에 속한 프로그램들을 조회하는 쿼리
SELECT * FROM BROADTIME 
JOIN BROAD_WEEK ON BT_WE_KEY = WE_KEY 
JOIN CHANNEL_PRO ON BT_CP_NUM = CP_NUM
JOIN CHANNEL ON CP_CH_NUM = CH_NUM
JOIN PROGRAM ON CP_PG_KEY = PG_KEY
WHERE CH_NAME = "MBC";

# - 요일을 선택하면 해당 요일에 방영되는 모든 프로그램들을 조회하는 쿼리
SELECT * FROM BROADTIME 
JOIN BROAD_WEEK ON BT_WE_KEY = WE_KEY 
JOIN CHANNEL_PRO ON BT_CP_NUM = CP_NUM
JOIN CHANNEL ON CP_CH_NUM = CH_NUM
JOIN PROGRAM ON CP_PG_KEY = PG_KEY
WHERE WE_NAME = "토";

SELECT * FROM BROADTIME 
JOIN BROAD_WEEK ON BT_WE_KEY = WE_KEY 
JOIN CHANNEL_PRO ON BT_CP_NUM = CP_NUM
JOIN CHANNEL ON CP_CH_NUM = CH_NUM
JOIN PROGRAM ON CP_PG_KEY = PG_KEY
WHERE CH_NAME = "MBC" AND WE_NAME IN ("토", "일", "월") 
;

# 유저를 선택하면 해당 유저가 즐겨찾기한 프로그램들을 조회하는 쿼리
SELECT PROGRAM.*, CH_NAME FROM PROGRAM 
JOIN USER_INDEX ON PG_KEY = IN_PG_KEY 
LEFT JOIN CHANNEL_PRO ON PG_KEY = CP_PG_KEY
JOIN CHANNEL ON CP_CH_NUM = CH_NUM
LEFT JOIN USER ON IN_US_KEY = US_KEY 
WHERE US_ID = "user1";



# 프로그램 선택 시, 해당 프로그램의 장르들을 조회하는 쿼리
SELECT * FROM PROGRAMGENRE 
RIGHT JOIN PROGRAM ON PR_PG_KEY = PG_KEY 
LEFT JOIN GENRE ON PR_GR_NUM = GR_NUM
WHERE PG_NAME = "무한도전";

# 즐겨찾기에 프로그램과 프로그램이 속한 요일,시간을 등록하는 쿼리
